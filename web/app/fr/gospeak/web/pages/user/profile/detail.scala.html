@import fr.gospeak.core.domain.{Group, Proposal}
@import fr.gospeak.libs.scalautils.domain.Page
@import fr.gospeak.web.domain.Breadcrumb
@import fr.gospeak.web.pages.partials.display.html._
@import fr.gospeak.web.pages.user.partials.html.{container, groupItem, proposalItemForProfile}
@import fr.gospeak.web.pages.user.profile.routes.ProfileCtrl
@import fr.gospeak.web.utils.UserReq

@(proposals: Page[Proposal.Full], ownedGroups: Seq[Group])(b: Breadcrumb)(implicit req: UserReq[AnyContent])
@container("My profile - Gospeak", b)() {
    <div class="row">
        <div class="col-4">
            <div class="card shadow-sm">
                <img src="@req.user.avatar.url.value" alt="@req.user.name.value avatar" class="avatar-lg align-self-center mt-1">
                <div class="card-body">
                    <h5 class="card-title d-flex justify-content-between align-items-center">
                        <span><small>@userProfileStatusIcon(req.user.status)</small> @req.user.name.value</span>
                        <a class="btn btn-primary btn-sm" href="@ProfileCtrl.edit()">Update</a>
                    </h5>
                    @req.user.bio.map { b => <p>@markdown(b)</p> }
                    <p class="text-secondary font-italic mb-0">
                        @emailLink(req.user.email)<br>
                        @req.user.phone.map { phone => @phoneLink(phone)<br> }
                        @req.user.website.map { url => @websiteLink(url) <br> }
                        @req.user.location.map { location => @locationDisplay(location)<br> }
                        @req.user.company.map { company => @companyDisplay(company)<br> }
                        @socialIcons(req.user.social)
                    </p>
                </div>
            </div>
        </div>
        <div class="col-8">
            @if(proposals.nonEmpty) {
                <div class="mb-3">
                    <h2>Accepted talks</h2>
                    @proposals.items.map { proposal =>
                        @proposalItemForProfile(proposal)
                    }
                </div>
            }
            @if(ownedGroups.nonEmpty) {
                <div class="mb-3">
                    <h2>Organises</h2>
                    @ownedGroups.map { group =>
                        @groupItem(group)
                    }
                </div>
            }
        </div>
    </div>
}()
